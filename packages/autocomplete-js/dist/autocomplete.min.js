var Autocomplete=function(){"use strict";function t(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var i=0;i<n.length;i++){var s=n[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,t(s.key),s)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(e,n,i){return(n=t(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var o=function(t,e){return t.matches?t.matches(e):t.msMatchesSelector?t.msMatchesSelector(e):t.webkitMatchesSelector?t.webkitMatchesSelector(e):null},u=function(t,e){return t.closest?t.closest(e):function(t,e){for(var n=t;n&&1===n.nodeType;){if(o(n,e))return n;n=n.parentNode}return null}(t,e)},r=function(t){return Boolean(t&&"function"==typeof t.then)},l=i((function t(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.search,l=i.autoSelect,a=void 0!==l&&l,c=i.setValue,d=void 0===c?function(){}:c,h=i.setAttribute,p=void 0===h?function(){}:h,b=i.onUpdate,f=void 0===b?function(){}:b,v=i.onSubmit,m=void 0===v?function(){}:v,L=i.onShow,y=void 0===L?function(){}:L,g=i.autocorrect,w=void 0!==g&&g,R=i.onHide,S=void 0===R?function(){}:R,x=i.onLoading,A=void 0===x?function(){}:x,E=i.onLoaded,k=void 0===E?function(){}:E,I=i.submitOnEnter,C=void 0!==I&&I;e(this,t),s(this,"value",""),s(this,"searchCounter",0),s(this,"results",[]),s(this,"selectedIndex",-1),s(this,"selectedResult",null),s(this,"destroy",(function(){n.search=null,n.setValue=null,n.setAttribute=null,n.onUpdate=null,n.onSubmit=null,n.autocorrect=null,n.onShow=null,n.onHide=null,n.onLoading=null,n.onLoaded=null})),s(this,"handleInput",(function(t){var e=t.target.value;n.updateResults(e),n.value=e})),s(this,"handleKeyDown",(function(t){var e=t.key;switch(e){case"Up":case"Down":case"ArrowUp":case"ArrowDown":var i="ArrowUp"===e||"Up"===e?n.selectedIndex-1:n.selectedIndex+1;t.preventDefault(),n.handleArrows(i);break;case"Tab":n.selectResult();break;case"Enter":var s=t.target.getAttribute("aria-activedescendant").length>0;n.selectedResult=n.results[n.selectedIndex]||n.selectedResult,n.selectResult(),n.submitOnEnter?n.selectedResult&&n.onSubmit(n.selectedResult):s?t.preventDefault():(n.selectedResult&&n.onSubmit(n.selectedResult),n.selectedResult=null);break;case"Esc":case"Escape":n.hideResults(),n.setValue();break;default:return}})),s(this,"handleFocus",(function(t){var e=t.target.value;n.updateResults(e),n.value=e})),s(this,"handleBlur",(function(){n.hideResults()})),s(this,"handleResultMouseDown",(function(t){t.preventDefault()})),s(this,"handleResultClick",(function(t){var e=t.target,i=u(e,"[data-result-index]");if(i){n.selectedIndex=parseInt(i.dataset.resultIndex,10);var s=n.results[n.selectedIndex];n.selectResult(),n.onSubmit(s)}})),s(this,"handleArrows",(function(t){var e=n.results.length;n.selectedIndex=(t%e+e)%e,n.onUpdate(n.results,n.selectedIndex)})),s(this,"selectResult",(function(){var t=n.results[n.selectedIndex];t&&n.setValue(t),n.hideResults()})),s(this,"updateResults",(function(t){var e=++n.searchCounter;n.onLoading(),n.search(t).then((function(t){e===n.searchCounter&&(n.results=t,n.onLoaded(),0!==n.results.length?(n.selectedIndex=n.autoSelect?0:-1,n.onUpdate(n.results,n.selectedIndex),n.showResults()):n.hideResults())}))})),s(this,"showResults",(function(){n.setAttribute("aria-expanded",!0),n.onShow()})),s(this,"hideResults",(function(){n.selectedIndex=-1,n.results=[],n.setAttribute("aria-expanded",!1),n.setAttribute("aria-activedescendant",""),n.onUpdate(n.results,n.selectedIndex),n.onHide()})),s(this,"checkSelectedResultVisible",(function(t){var e=t.querySelector('[data-result-index="'.concat(n.selectedIndex,'"]'));if(e){var i=t.getBoundingClientRect(),s=e.getBoundingClientRect();s.top<i.top?t.scrollTop-=i.top-s.top:s.bottom>i.bottom&&(t.scrollTop+=s.bottom-i.bottom)}})),this.search=r(o)?o:function(t){return Promise.resolve(o(t))},this.autoSelect=a,this.setValue=d,this.setAttribute=p,this.onUpdate=f,this.onSubmit=m,this.autocorrect=w,this.onShow=y,this.onHide=S,this.onLoading=A,this.onLoaded=k,this.submitOnEnter=C})),a=0,c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(t).concat(++a)},d=function(t,e){var n=t.getBoundingClientRect(),i=e.getBoundingClientRect();return n.bottom+i.height>window.innerHeight&&window.innerHeight-n.bottom<n.top&&window.pageYOffset+n.top-i.height>0?"above":"below"},h=function(t,e,n){var i;return function(){var s=this,o=arguments,u=function(){i=null,n||t.apply(s,o)},r=n&&!i;clearTimeout(i),i=setTimeout(u,e),r&&t.apply(s,o)}},p=function(t){if(null!=t&&t.length){var e=t.startsWith("#");return{attribute:e?"aria-labelledby":"aria-label",content:e?t.substring(1):t}}},b=function(){function t(n,i,s){e(this,t),this.id="".concat(s,"-result-").concat(n),this.class="".concat(s,"-result"),this["data-result-index"]=n,this.role="option",n===i&&(this["aria-selected"]="true")}return i(t,[{key:"toString",value:function(){var t=this;return Object.keys(this).reduce((function(e,n){return"".concat(e," ").concat(n,'="').concat(t[n],'"')}),"")}}]),t}();return i((function t(n){var i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=o.search,r=o.onSubmit,a=void 0===r?function(){}:r,f=o.onUpdate,v=void 0===f?function(){}:f,m=o.baseClass,L=void 0===m?"autocomplete":m,y=o.autocorrect,g=void 0!==y&&y,w=o.autoSelect,R=o.getResultValue,S=void 0===R?function(t){return t}:R,x=o.renderResult,A=o.debounceTime,E=void 0===A?0:A,k=o.resultListLabel,I=o.submitOnEnter,C=void 0!==I&&I;e(this,t),s(this,"expanded",!1),s(this,"loading",!1),s(this,"position",{}),s(this,"resetPosition",!0),s(this,"initialize",(function(){i.root.style.position="relative",i.input.setAttribute("role","combobox"),i.input.setAttribute("autocomplete","off"),i.input.setAttribute("autocapitalize","off"),i.autocorrect&&i.input.setAttribute("autocorrect","on"),i.input.setAttribute("spellcheck","false"),i.input.setAttribute("aria-autocomplete","list"),i.input.setAttribute("aria-haspopup","listbox"),i.input.setAttribute("aria-expanded","false"),i.resultList.setAttribute("role","listbox");var t=p(i.resultListLabel);t&&i.resultList.setAttribute(t.attribute,t.content),i.resultList.style.position="absolute",i.resultList.style.zIndex="1",i.resultList.style.width="100%",i.resultList.style.boxSizing="border-box",i.resultList.id||(i.resultList.id=c("".concat(i.baseClass,"-result-list-"))),i.input.setAttribute("aria-owns",i.resultList.id),document.body.addEventListener("click",i.handleDocumentClick),i.input.addEventListener("input",i.core.handleInput),i.input.addEventListener("keydown",i.core.handleKeyDown),i.input.addEventListener("focus",i.core.handleFocus),i.input.addEventListener("blur",i.core.handleBlur),i.resultList.addEventListener("mousedown",i.core.handleResultMouseDown),i.resultList.addEventListener("click",i.core.handleResultClick),i.updateStyle()})),s(this,"destroy",(function(){document.body.removeEventListener("click",i.handleDocumentClick),i.input.removeEventListener("input",i.core.handleInput),i.input.removeEventListener("keydown",i.core.handleKeyDown),i.input.removeEventListener("focus",i.core.handleFocus),i.input.removeEventListener("blur",i.core.handleBlur),i.resultList.removeEventListener("mousedown",i.core.handleResultMouseDown),i.resultList.removeEventListener("click",i.core.handleResultClick),i.root=null,i.input=null,i.resultList=null,i.getResultValue=null,i.onUpdate=null,i.renderResult=null,i.core.destroy(),i.core=null})),s(this,"setAttribute",(function(t,e){i.input.setAttribute(t,e)})),s(this,"setValue",(function(t){i.input.value=t?i.getResultValue(t):""})),s(this,"renderResult",(function(t,e){return"<li ".concat(e,">").concat(i.getResultValue(t),"</li>")})),s(this,"handleUpdate",(function(t,e){i.resultList.innerHTML="",t.forEach((function(t,n){var s=new b(n,e,i.baseClass),o=i.renderResult(t,s);"string"==typeof o?i.resultList.insertAdjacentHTML("beforeend",o):i.resultList.insertAdjacentElement("beforeend",o)})),i.input.setAttribute("aria-activedescendant",e>-1?"".concat(i.baseClass,"-result-").concat(e):""),i.resetPosition&&(i.resetPosition=!1,i.position=d(i.input,i.resultList),i.updateStyle()),i.core.checkSelectedResultVisible(i.resultList),i.onUpdate(t,e)})),s(this,"handleShow",(function(){i.expanded=!0,i.updateStyle()})),s(this,"handleHide",(function(){i.expanded=!1,i.resetPosition=!0,i.updateStyle()})),s(this,"handleLoading",(function(){i.loading=!0,i.updateStyle()})),s(this,"handleLoaded",(function(){i.loading=!1,i.updateStyle()})),s(this,"handleDocumentClick",(function(t){i.root.contains(t.target)||i.core.hideResults()})),s(this,"updateStyle",(function(){i.root.dataset.expanded=i.expanded,i.root.dataset.loading=i.loading,i.root.dataset.position=i.position,i.resultList.style.visibility=i.expanded?"visible":"hidden",i.resultList.style.pointerEvents=i.expanded?"auto":"none","below"===i.position?(i.resultList.style.bottom=null,i.resultList.style.top="100%"):(i.resultList.style.top=null,i.resultList.style.bottom="100%")})),this.root="string"==typeof n?document.querySelector(n):n,this.input=this.root.querySelector("input"),this.resultList=this.root.querySelector("ul"),this.baseClass=L,this.autocorrect=g,this.getResultValue=S,this.onUpdate=v,"function"==typeof x&&(this.renderResult=x),this.resultListLabel=k,this.submitOnEnter=C;var U=new l({search:u,autoSelect:w,setValue:this.setValue,setAttribute:this.setAttribute,onUpdate:this.handleUpdate,autocorrect:this.autocorrect,onSubmit:a,onShow:this.handleShow,onHide:this.handleHide,onLoading:this.handleLoading,onLoaded:this.handleLoaded,submitOnEnter:this.submitOnEnter});E>0&&(U.handleInput=h(U.handleInput,E)),this.core=U,this.initialize()}))}();
